---
layout: post
title: Learning(and Teaching) Web-Sec — Day 17 — Directory/Path Traversal Vulnerabilities
tag:
- infosec
- cybersecurity
- hacking
- web-security
---

<h3>Learning Web-Sec — Day 17 — Directory/Path Traversal Vulnerabilities</h3><h4>Introduction — Part I of Diving in the Realm of Directory Traversal Vulnerabilities</h4><figure><img alt="" src="https://cdn-images-1.medium.com/max/781/1*zZb_YvR1T-Q4SQI-tv74kQ.png" /><figcaption>Image Credits: <a href="https://portswigger.net/web-security/file-path-traversal">PortSwigger</a></figcaption></figure><h3>What is Directory Traversal?</h3><p>Directory Traversal/Path Traversal is a web app security vulnerability which <strong>allows</strong> an attacker <strong>to read/retrieve</strong> the files available <strong>on the system/server</strong> which is running the application. This file can be anything like the <strong>application’s code and data, user’s database, login credentials, sensitive information files</strong>, etc. In some cases, the attacker might be<strong> able</strong> to <strong>write arbitrary files</strong> on the server allowing modification of any data <strong>leading to</strong> full <strong>control over the system/server.</strong></p><h4>Reading Arbitrary Files via Directory Traversal</h4><p>Suppose a shopping application loads a file from the system/server to display it to us and the filename is passed as a parameter to the application. It work’s something like this:</p><pre>&lt;img src=&quot;/loadImage?filename=guitar.png&quot;&gt;</pre><p>The <strong>loadImage</strong> URL takes the name of a file i.e. <strong>filename</strong> as a parameter and displays it to the end user.</p><p>Let’s suppose that the <strong>images</strong> for the website <strong>are stored at</strong></p><pre>/var/www/staic/images</pre><p>To return an image specified in the URL using the <strong>filename</strong>, the <strong>filename is appended</strong> to the <strong>path</strong>. i.e. the path for the image becomes:</p><pre>/var/www/static/images/guitar.png</pre><p>If the <strong>application doesn’t implement secure code</strong> against directory traversal attacks, the <strong>attacker can</strong> perform the attack to <strong>read/retrieve</strong> <strong>arbitrary files on the system/server.</strong></p><p>Suppose the attacker makes the requests for the URL</p><pre>https://website.com/loadImage?filename=../../../../../etc/passwd[Insert Link to Your Medium Blog Post]</pre><p>This makes the application retrieve the file which is at:</p><pre>/var/www/static/images/../../../../../etc/passwd</pre><p>And if you’ve worked with directories before, you know what the attacker is trying to do and if you’re not sure, just know that ../ is used to <strong>go to the parent directory</strong> of the current directory. So, when ../ is used multiple times,</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1006/1*FJZiYoqqBhSkN7hx9CRClw.png" /><figcaption>Usage of <strong>../ </strong>in commands</figcaption></figure><p>As you can see above. It goes to the parent directory</p><p>So, loading the file <strong>/var/www/static/images/../../../../../etc/passw</strong>d would result in:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1006/1*BuS22pEcilaF7iYIco-8PA.png" /></figure><p>The <strong>../../../../..</strong> <strong>takes</strong> the system <strong>to the</strong> <strong>root directory</strong>. And then the <strong>/etc/passwd</strong> accessed.</p><p>The <strong>/etc/passwd</strong> file is a standard file on <strong>Unix</strong> type systems which stores essential information required during login. In other words, it <strong>stores user account information</strong>. The <strong>/etc/passwd</strong> is a plain text file. It contains a list of the <strong>system’s accounts</strong>, giving for each account some useful information like <strong>user ID, group ID, home directory, shell, and more</strong>.<br><strong>(Source: </strong><a href="https://www.cyberciti.biz/faq/understanding-etcpasswd-file-format/"><strong>cyberciti.biz</strong></a><strong>)</strong></p><p>For directory traversal attacks on windows system, you can try retrieving the <strong>C:/Windows/win.ini</strong> or <strong>C:/Windows/system.ini</strong> file while checking for directory traversal attacks.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1006/1*UWw1rWWKX371B3mkgdXZyQ.png" /><figcaption>Default system files present in windows OS.</figcaption></figure><p><em>The above files are from the </em><strong><em>Windows Drive</em></strong><em>.</em></p><p>In the upcoming blogs, I will walk you through the Directory Traversal Vulnerability labs from <strong>PortSwigger’s Web Application Security Academy.</strong></p><blockquote>Dear readers,</blockquote><blockquote>I appreciate your time and attention in reading my blog post. If you found the content valuable and insightful, I kindly encourage you to show your support by following, applauding, and leaving a comment. Your engagement fuels my motivation to continue sharing knowledge and insights on this platform. I look forward to hearing your thoughts and connecting with you further.</blockquote><blockquote>Thank you,<br>Nimish Dudhe</blockquote><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=5756064caa01" width="1" height="1" alt=""><hr><p><a href="https://systemweakness.com/learning-and-teaching-web-sec-day-17-directory-path-traversal-vulnerabilities-5756064caa01">Learning(and Teaching) Web-Sec — Day 17 — Directory/Path Traversal Vulnerabilities</a> was originally published in <a href="https://systemweakness.com">System Weakness</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
