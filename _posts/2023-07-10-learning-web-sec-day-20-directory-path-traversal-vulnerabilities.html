---
layout: post
title: Learning Web-Sec — Day 20— Directory/Path Traversal Vulnerabilities
tag:
- bug-bounty
- web-security
- ethical-hacking
- directory-traversal
- infosec
---

<h3>Learning Web-Sec — Day 20— Directory/Path Traversal Vulnerabilities</h3><h4>Part III — Solving PortSwigger’s Lab 3 and 4 of Directory Traversal</h4><blockquote>In today’s blog, we’ll delve into the exciting 3rd and 4th lab focused on Directory Traversal, offered by PortSwigger’s Academy.</blockquote><h4>Lab 3 — File path traversal, traversal sequences stripped non-recursively (<a href="https://portswigger.net/web-security/file-path-traversal/lab-sequences-stripped-non-recursively">Link</a>)</h4><p>Level of Lab: Practitioner</p><p>Description of Lab:</p><blockquote>This lab contains a file path traversal vulnerability in the display of product images.</blockquote><blockquote>The application strips path traversal sequences from the user-supplied filename before using it.</blockquote><blockquote>To solve the lab, retrieve the contents of the /etc/passwd file.</blockquote><ol><li>Access the lab.</li></ol><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*FuGZ0cVhhosJcLKeM3e92Q.png" /></figure><p>2. Let’s again open one of the images in a new tab.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*KJyU_B8FLitaL-poLTY1Dw.png" /></figure><p>3. Let’s now try the previous directory traversal methods.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Xc2U_ZmzfU7vfCsM-bKFiA.png" /></figure><p>The first one didn’t work.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*dBNwm9_59W5Ub1kWht9wYA.png" /></figure><p>The second one didn’t work too. So, we need to try something new.</p><p>4. The payload we tried is <strong>….//….//….//….//….//….//etc/passwd</strong> and we are successful.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*bkFICAupSrmylQZgz5x9vg.png" /></figure><p>5. We successfully solved the lab.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*G_bTHr8-4wRiDdQGDMcM7A.png" /></figure><p><strong>Now let’s try to figure out what’s happening in the back-end</strong></p><p>The payload <strong>../../8.jpg</strong> didn’t work. This means that either we weren’t able to go to the parent directory or the image is in the root directory which most probably isn’t the case.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*fJ7yOY6tH-vdesxUhDAsSQ.png" /></figure><p>So, it might be that the actual parameter that loaded the image somehow became <strong>8.jpg</strong> or <strong>././8.jpg</strong>. In the first case, the application must be programmed as <strong>replace(‘../’,’’)</strong> to remove the going to parent directory action. And in the second case, the program might be programmed as <strong>replace(‘../’,’./’)</strong> to change the parent directory to the current directory. Which is the reason why the image still loads.</p><p>Here the payload <strong>…/../8.jpg</strong> caused an error successfully. This means that either one of the two happened and the effective filename became either <strong>.8.jpg</strong> or <strong>.././8.jpg</strong>. In both cases, file wont be found as there doesn’t exit a file <strong>.8.jpg</strong> in the current directory and <strong>8.jpg</strong> in the parent directory.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*dPGQ2RzocgXzUzFvy7G3qA.png" /></figure><p>So, this explains why our payload <strong>….//….//….//….//….//….//etc/passwd </strong>worked. It must’ve translated to an effective filename which is either <strong>../../../../../../etc/passwd</strong>. As the other effective filename i.e. : <strong>…//…//…//…//…//…//etc/passwd</strong> isn’t valid.</p><h4>Lab 4 — File path traversal, traversal sequences stripped with superfluous URL-decode (<a href="https://portswigger.net/web-security/file-path-traversal/lab-superfluous-url-decode">Link</a>)</h4><p>Level of Lab: Practitioner</p><p>Description of Lab:</p><blockquote>This lab contains a file path traversal vulnerability in the display of product images.</blockquote><blockquote>The application blocks input containing path traversal sequences. It then performs a URL-decode of the input before using it.</blockquote><blockquote>To solve the lab, retrieve the contents of the /etc/passwd file.</blockquote><ol><li>Access the lab.</li></ol><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*DWBx8rna8FBGQaL_4yqskw.png" /></figure><p>2. Open any image in a new tab.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*x1_FVD4VgDJKpGx1-i6pPw.png" /></figure><p>3. Let’s try our basic directory traversal attack.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*AwL6_7J-bd67toVv_6T-sQ.png" /></figure><p>It didn’t work.</p><p>4. Let’s now try encoding the payload for bypassing the sanitization technique.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/875/1*mOeekp1DP1afb9TuBv3RjQ.png" /></figure><p>Here’s the URL encoded payload.</p><p>5. The payload didn’t work.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*2CBPClRDJ1Q-tJR2KUZkyg.png" /></figure><p>6. Now let’s again URL encode the payload.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/415/1*hh5cy_0mLEluk1XYRZQHAw.png" /></figure><p>Now the % will be converted to \%25</p><p>7. Here we can see that we didn’t get a `No such file` error, This means that we were successful in performing directory traversal attack.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*9iS32skV28161ou2iAqlyQ.png" /></figure><p>8. And we’re done solving the lab.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*CWBAcWA5DVOkSiqwDhvgig.png" /></figure><blockquote>Dear readers,</blockquote><blockquote>I appreciate your time and attention in reading my blog post. If you found the content valuable and insightful, I kindly encourage you to show your support by following, applauding, and leaving a comment. Your engagement fuels my motivation to continue sharing knowledge and insights on this platform. I look forward to hearing your thoughts and connecting with you further.</blockquote><blockquote>Thank you,<br>Nimish Dudhe</blockquote><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=fa80afffb44c" width="1" height="1" alt=""><hr><p><a href="https://systemweakness.com/learning-web-sec-day-20-directory-path-traversal-vulnerabilities-fa80afffb44c">Learning Web-Sec — Day 20— Directory/Path Traversal Vulnerabilities</a> was originally published in <a href="https://systemweakness.com">System Weakness</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
